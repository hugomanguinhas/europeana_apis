This document describes the changes of Europeana API. The changes are grouped by new API versions.

<section>
<p>This document describes the changes of Europeana API. The changes are grouped by new API versions. We deploy new versions of the portal and API quite regularly, but not all new versions result in changes in the interface. The API documentation always describes the current version of the API.</p>

<h2>Deprecation information</h2>

<p>The following will be deprecated per the given date, ensure that your API clients are updated accordingly:</p>

<ul>
	<li>As the API supports SSL now for a while, we will start to redirect all non-SSL traffic for the API to SSL. Ensure your applications follow redirects if needed or adjust the hostname to use SSL. <strong>(Q3 2017)</strong></li>
</ul>

<h2>Version 2.6.5 (2017-09-06)</h2>

<p>This release includes:</p>

<ul>
	<li>Thumbnail urls (in edmPreview) now start with <em>https://www.europeana.eu/api/v2/thumbnail-by-url.json?</em> instead of <em>http://europeanastatic.eu/api/image?</em></li>
	<li>Improved thumbnail loading speed</li>
	<li>Improved logging</li>
	<li>Proper error message when requesting non-existing sitemap file</li>
</ul>

<h2>Version 2.6.4 (2017-08-02)</h2>

<p>This release includes various changes in the EDM model</p>

<h2>Version 2.6.3 (2017-07-20)</h2>

<p>This release includes:</p>

<ul>
	<li>Thumbnail queries now support browser caching (query response returns ETag and LastModified information)</li>
	<li>Hierarchy queries can now timeout with a 504 response</li>
	<li>Improved the way records queries are handled</li>
	<li>Improved error handling (errors for RDF requests now return proper xml)</li>
	<li>Fixed an issue with https:// in reusability urls</li>
	<li>Fix bug where webresource metadata would be retrieved from an incorrect and old database</li>
	<li>Deprecated the 'description' field in EDM (replaced by dcDescription)</li>
	<li>Refactored how mongo and postgres database connections are defined</li>
	<li>Removed some old and obsolete code</li>
</ul>

<h2>Version 2.6.2 (2017-06-02)</h2>

<p>This release includes:</p>

<ul>
	<li>Faster thumbnail retrieval</li>
	<li>Maximum time limit when checking if record has hierarchy</li>
	<li>Debug option to output Solr query information</li>
</ul>

<h2>Version 2.6.1 (2017-04-10)</h2>

<p>This release includes:</p>

<ul>
	<li>Upgrade of the Mongo and Morphia drivers</li>
	<li>Revision of the Mongo login procedure</li>
	<li>New default thumbnails for when a media file doesn't exist</li>
	<li>Fix for the search limit (now including the 1000th result)</li>
	<li>EDM schema change</li>
</ul>

<h2>Version 2.6.0 (2017-02-13)</h2>

<div class="markdown-body">
<p>In this release we've addressed the following:</p>

<ul>
	<li>Added data inconsistency checks for record queries</li>
	<li>Reduced the amount of data included in query results that use the minimal profile</li>
	<li>Fixed a problem when doing opensearch.rss queries with text/html accept-header (commonly used by browsers)</li>
</ul>
</div>

<h2>Version 2.5.2 (2017-01-17)</h2>

<p>In this release we've addressed the following:</p>

<ul>
	<li>Fixed empty sameAs statements in JSON-LD and RDF record query results.</li>
	<li>Add correct labels for Rightsstatements.org licences to the attribution snippet.</li>
</ul>

<h2>Version 2.5.1 (2016-11-03)</h2>

<p>In this release we've addressed the following:</p>

<ul>
	<li>The 'action' field in all responses has been removed announced. Note that this is not part of any record information.</li>
	<li>The IMAGE_GREYSCALE facet has been removed, use the IMAGE_COLOUR facet instead (use 'false' as value for greyscale images).</li>
</ul>

<h2>Version 2.5 (2016-10-05)</h2>

<p>In this release we've addressed the following:</p>

<ul>
	<li>Updated our data model with the latest version of the <a href="http://pro.europeana.eu/page/edm-documentation" target="_blank">Europeana Data Model</a>, which for instance ensures that WebResources available <a href="http://pro.europeana.eu/files/Europeana_Professional/Share_your_data/Technical_requirements/EDM_profiles/IIIFtoEDM_profile_042016.pdf" target="_blank">via IIIF</a> are fully represented in the record API, for instance as part of <a href="http://www.europeana.eu/portal/record/07931/diglit_baer1877.html" target="_blank">this record</a>.</li>
	<li>Updated the reusability facet/filter to include the upcoming <a href="http://rightsstatements.org/" target="_blank">rightsstatements.org licences</a> which will be used in Europeana records as from November to replace the current Europeana.eu rights statements.</li>
	<li>We've aligned the logic for faceting across all fields in the API output to be consistent. Previously, faceting on the 'default' facets (such as TYPE, or RIGHTS) would use a different logic than faceting on custom fields (such as proxy_dc_creator). The difference is that now all other values in a list of facet values are returned (multi-facet).</li>
</ul>

<h2>Version 2.4 (2016-09-22)</h2>

<p>In this release we've addressed the following:</p>

<ul>
	<li>Improved the way facet limitations are set in the API. Before this release, different kinds of facets had different limits (eg some would return 50 labels, others up to 750 or even 3000). With this release, all facets have a default limit of 50 labels. This means a query which asks for the data provider facet (&amp;facet=DATA_PROVIDER) will return 50 labels unless you explicitly set the limit higher (e.g. &amp;f.DATA_PROVIDER.facet.limit=100).</li>
	<li>Further worked on bringing back and updating the MyEuropeana API methods, in this sprint we've addressed the method to update saved searches. All the improved MyEuropeana methods will be published in the remainder of 2016.</li>
	<li>Fixed a bug where the emails sent from the API (with for instance API key registration) were not sent from a Europeana email address.</li>
</ul>

<h2>Version 2.3.6 (2016-08-24)</h2>

<p>In this release we've addressed the following:</p>

<ul>
	<li>Made the API core more robust by ensuring that it always gives a JSON-formatted response, in particular in cases where the connection with (some of) the data backends fail.</li>
	<li>Made the user role part of the GET user method (administrative functions).</li>
</ul>

<h2>Version 2.3.5 (2016-07-19)</h2>

<p>In this release we've addressed the following:</p>

<ul>
	<li>Updated our <a href="http://www.europeana.eu/api/api-docs/" target="_blank">Swagger API spec</a> to allow our new <a href="http://labs.europeana.eu/api/console/" target="_blank">API console</a> to be launched, allowing developers to simulate and test API queries in an easy manner.</li>
	<li>Fixed a bug where requesting one technical metadata facet did not work.</li>
</ul>

<h2>Version 2.3.4 (2016-05-31)</h2>

<p>In this release we've addressed the following:</p>

<ul>
	<li>Fixed an issue where searching for file mime-types such as "application/pdf" did not return any results.</li>
	<li>Fixed an issue where facets were not all returned if more than 16 were requested, as a result we've increased the number of maximum facets you can request to 100.</li>
	<li>Addressed an issue where in some occasions, the number of requested facets would get multiplied to the point where the search query would fail.</li>
</ul>

<h2>Version 2.3.3 (2016-05-12)</h2>

<p>In this release we've addressed the following:</p>

<ul>
	<li>Fixed an issue with the API key signup not sending out emails anymore.</li>
	<li>We've improved the behaviour of our technical metadata facets such as IMAGE_SIZE, they now behave more like all the other facets. You can include them in the parameters used for offsets and facet profiles.</li>
	<li>Enhanced the attribution snippet to also include the license expiration date if an object's license has one (Out of copyright - No commercial re-use until xxxx-xx-xx).</li>
	<li>Published the first version of our <a href="/api/hierarchical-records/">hierarchical API</a>, which allows you to search for and retrieve hierarchical structures in records and our <a href="/api/thumbnails/">thumbnail API</a>), which can render thumbnail images for Europeana records.</li>
</ul>

<p>With this release we also announce the <b>deprecation</b> of some API functionalities. See the heading at the top for an overview.</p>

<h2>Version 2.3.2 (2016-03-10)</h2>

<p>In this release we've fixed an issue where searching on media items with mime-types such as PDF or XML wouldn't return any records (all the application/* mime-types).</p>

<h2>Version 2.3.1 (2016-02-24)</h2>

<p>This API release contains mostly fixes and small enhancements. Note that as from this release onwards we've aligned the API version number with the version of our corelib software (which powers the API), which explains the jump in versioning from the previous version (2.0.15).</p>

<h3>Notable changes:</h3>

<ul>
	<li>The Europeana tracking code (&amp;bt=europeanaapi) which was appended to URLs in the edm:isShownAt field of individual records (both in search and record calls) is now removed, this prevented some URLs to be properly loaded.</li>
	<li>A bug was fixed where the API search without any result would not return the fields for totalItems and items anymore.</li>
	<li>A bug was fixed where the faceted search for the UGC field didn't work as documented.</li>
	<li>Improvements were made to the Hierarchical API methods, which allows for the display of hierarchical structures. This API will soon be fully documented on Europeana Labs.</li>
	<li>In this release we've had to deprecate the <a href="http://labs.europeana.eu/api/suggestions/">suggestions API method</a>, it will in the near future be replaced by an improved API which can be used to power suggestions for search.</li>
	<li>If an invalid cursor is provided for the cursor-based pagination, the error message now indicates the cursor is invalid rather than a generic error.</li>
	<li>Thumbnail images are now returned with an HTTP status code of 200 rather than 201 to fix some embedding issues.</li>
</ul>

<h2>Version 2.0.15 (2015-12-16)</h2>

<p>In this API release we focussed on features to support the new <a href="http://www.europeana.eu/" target="_blank">Europeana Collections</a> website which is based on the API. We fixed a few bugs and ensured that the API always returns errors in json format only.</p>

<h3>Sort records by timestamps in search</h3>

<p>Use the new sort parameter in the search call to sort search results by timestamp. The sort function accepts a field (either timestamp_created which represents the date and time when a record was added to Europeana or timestamp_update which represents the last update) and an order (asc or desc).</p>

<blockquote>
<p>search.json?wskey=xxxx&amp;query=Paris&amp;sort=timestamp_update+desc</p>
</blockquote>

<h3>Licensing header in API response headers</h3>

<p>To clearly indicate the correct rights label for Europeana's metadata all 200 OK responses include the following link header:</p>

<blockquote>Link:&lt;http://creativecommons.org/publicdomain/zero/1.0/&gt;;rel=license</blockquote>

<h3>Attribution snippet in records</h3>

<p>In order to make it easier to attribute the creators and institutions of the media resources we have added a attribution snippet to each WebResource element in the record response. The attribution snippet is available as text (textAttributionSnippet) and in HTML (htmlAttributionSnippet).</p>
Example output of the HTML attribution snippet:

<blockquote><span about="http://data.europeana.eu/item/92094/BibliographicResource_1000086165662"><a href="http://europeana.eu/portal/record/92094/BibliographicResource_1000086165662.html"><span property="dc:title">Pèlerinage de la vie humaine</span></a>. <span property="dc:creator">Guillaume de Deguilleville. </span><a href="http://bodley30.bodley.ox.ac.uk:8180/luna/servlet/detail/ODLodl~24~24~107013~138638">Bodleian Libraries, University of Oxford</a>. <a href="http://www.europeana.eu/rights/rr-f/" rel="xhv:license http://www.europeana.eu/schemas/edm/rights">Rights Reserved - Free Access</a><span rel="cc:useGuidelines" resource="http://www.europeana.eu/rights/pd-usage-guide/">.</span></span></blockquote>

<h3>Multilingual labels for search fields</h3>

<p>To be able to get language tags in the search response for fields that are multilingual we have added a *langAware field for each multilingual field. In order to preserve backwards compatibility we have not changed the original fields. This means that fields such as title, description and creator now appear twice in the search response, one with their original field name (dcTitle) and one as a multilingual labelled list (dcTitleLangAware). In the future we will replace the single-value fields for the correct multilingual ones.</p>

<h2>Version 2.0.14 (2015-11-23)</h2>

<h3>Support for cursor-based pagination, limitation for basic pagination</h3>

<p>As we've noticed that searches with a high offset (beyond 1000 records) were quite slow on our ever-growing index, we have improved and changed the way the API can paginate and iterate over records. The normal way of pagination (with the start, being the offset parameter) will still be supported but limited to the first 1000 records. For API users with larger needs or harvesting use-cases, we have also added a cursor-based navigation to the API. See the <a href="/api/search#pagination">Search API</a> page for a full overview of all pagination parameters.</p>

<table style="width: 902px;">
	<thead>
		<tr>
			<th style="width: 117px;">Pagination</th>
			<th style="width: 385px;">Capabilities</th>
			<th style="width: 380px;">Implementation</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td style="width: 117px;">Basic</td>
			<td style="width: 385px;">Allows to go to a specific offset/page (start=X).<br />
			Limited to the first 1000 results (start + rows).</td>
			<td style="width: 380px;">Use the start parameter to set the search result offset, default value is 1.</td>
		</tr>
		<tr>
			<td style="width: 117px;">Cursor-based</td>
			<td style="width: 385px;">Quickly iterate over the entire result set.<br />
			Does not allow you to go to a specific offset.<br />
			Cannot be used in conjunction with the start parameter.<br />
			Based on <a href="https://cwiki.apache.org/confluence/display/solr/Pagination+of+Results">Solr Cursor Pagination</a>.</td>
			<td style="width: 380px;">Set the cursor parameter to * to start cursor-based pagination at page 1.<br />
			Take the nextCursor value from the response and pass it to the cursor parameter to paginate to the next page.<br />
			When the nextCursor value is not returned anymore, you have reached the end of the search result set.</td>
		</tr>
	</tbody>
</table>

<h3>Search and retrieval of technical metadata</h3>

<p>The API is extended with powerful features based on technical metadata. Technical metadata is metadata which is extracted from media files which reside in records, such as the width and height of an image. These new features give you the possibility to search for and filter on Europeana records by media information, for instance to only search for records which have extra large images, high-quality audio files, or which images match a particular colour. As for the API this means there are new parameters available in the <a href="/api/search/#request">search API</a>, we've added <a href="/api/data-fields/#technical-metadata-facets">new facets</a> for powerful search and filtering and we've updated the <a href="/api/record/#response">response in the record API</a> to make this metadata available to you.</p>

<p>An overview of the new API parameters:</p>

<table>
	<thead>
		<tr>
			<th style="width: 88px;">Parameter</th>
			<th style="width: 93px;">Datatype</th>
			<th style="width: 701px;">Description</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td style="width: 88px;">media</td>
			<td style="width: 93px;">Boolean</td>
			<td style="width: 701px;">Filter by records where an URL to the full media file is present in the edm:isShownBy or edm:hasView metadata and is resolvable.</td>
		</tr>
		<tr>
			<td style="width: 88px;">colourpalette</td>
			<td style="width: 93px;">String</td>
			<td style="width: 701px;">Filter by images where one of the colours of an image matches the provided colour code. You can provide this parameter multiple times, the search will then do an 'AND' search on all the provided colours. See <a href="/api/search/#colour-palette">colour palette</a>.</td>
		</tr>
	</tbody>
</table>

<p>An overview of the new facets:</p>

<table>
	<thead>
		<tr>
			<th style="width: 187px;">Facet name</th>
			<th style="width: 87px;">Datatype</th>
			<th style="width: 115px;">Media type</th>
			<th style="width: 487px;">Description</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td style="width: 187px;">MEDIA</td>
			<td style="width: 87px;">boolean</td>
			<td style="width: 115px;"></td>
			<td style="width: 487px;">To indicate whether an URL to the full media file is present in the edm:isShownBy or edm:hasView metadata and is resolvable.</td>
		</tr>
		<tr>
			<td style="width: 187px;">MIME_TYPE</td>
			<td style="width: 87px;">string</td>
			<td style="width: 115px;"></td>
			<td style="width: 487px;">Mime-type of the file, e.g. image/jpeg</td>
		</tr>
		<tr>
			<td style="width: 187px;">IMAGE_SIZE</td>
			<td style="width: 87px;">string</td>
			<td style="width: 115px;">Image</td>
			<td style="width: 487px;">Size in megapixels of an image, values: small (&lt; 0.5MP), medium (0.5-1MP), large (1-4MP) and extra_large (&gt; 4MP)</td>
		</tr>
		<tr>
			<td style="width: 187px;">IMAGE_COLOUR</td>
			<td style="width: 87px;">boolean</td>
			<td style="width: 115px;">Image</td>
			<td style="width: 487px;">Lists 'true' for colour images. An alias to this facet is IMAGE_COLOR, note that for non-colour images you cannot provide the 'false' value. Use the greyscale-facet instead.</td>
		</tr>
		<tr>
			<td style="width: 187px;">IMAGE_GREYSCALE</td>
			<td style="width: 87px;">boolean</td>
			<td style="width: 115px;">Image</td>
			<td style="width: 487px;">Lists 'true' for greyscale images. An alias to this facet is IMAGE_GRAYSCALE, note that for colour images you cannot provide the 'false' value. Use the colour-facet instead.</td>
		</tr>
		<tr>
			<td style="width: 187px;">COLOURPALETTE</td>
			<td style="width: 87px;">string</td>
			<td style="width: 115px;">Image</td>
			<td style="width: 487px;">The most dominant colours present in images, expressed in HEX-colour codes. See <a href="/api/search/#colour-palette">colour palette</a>.</td>
		</tr>
		<tr>
			<td style="width: 187px;">IMAGE_ASPECTRATIO</td>
			<td style="width: 87px;">string</td>
			<td style="width: 115px;">Image</td>
			<td style="width: 487px;">Portrait or landscape.</td>
		</tr>
		<tr>
			<td style="width: 187px;">VIDEO_HD</td>
			<td style="width: 87px;">boolean</td>
			<td style="width: 115px;">Video</td>
			<td style="width: 487px;">Lists 'true' for videos that have a resolution higher than 576p.</td>
		</tr>
		<tr>
			<td style="width: 187px;">VIDEO_DURATION</td>
			<td style="width: 87px;">string</td>
			<td style="width: 115px;">Video</td>
			<td style="width: 487px;">Duration of the video, values: short (&lt; 4 minutes), medium (4-20 minutes) and long (&gt; 20 minutes).</td>
		</tr>
		<tr>
			<td style="width: 187px;">SOUND_HQ</td>
			<td style="width: 87px;">boolean</td>
			<td style="width: 115px;">Sound</td>
			<td style="width: 487px;">Lists 'true' for sound files where the bit depth is 16 or higher or if the file format is a lossless file type (ALAC, FLAC, APE, SHN, WAV, WMA, AIFF &amp; DSD). Note that 'false' does not work for this facet.</td>
		</tr>
		<tr>
			<td style="width: 187px;">SOUND_DURATION</td>
			<td style="width: 87px;">string</td>
			<td style="width: 115px;">Sound</td>
			<td style="width: 487px;">Duration of the sound file, values: very_short (&lt; 30 seconds), short (30 seconds - 3 minutes), medium (3-6 minutes) and long (&gt; 6 minutes).</td>
		</tr>
		<tr>
			<td style="width: 187px;">TEXT_FULLTEXT</td>
			<td style="width: 87px;">boolean</td>
			<td style="width: 115px;">Text</td>
			<td style="width: 487px;">Lists 'true' for text media types which are searchable, e.g. a PDF with text.</td>
		</tr>
	</tbody>
</table>

<p>Examples:</p>

<p>Find all records that match the query ‘Paris’ which are openly licensed and have large images:</p>

<blockquote>
<p>search.json?wskey=xxxx&amp;query=Paris&amp;reusability=open&amp;qf=IMAGE_SIZE:large</p>
</blockquote>
<a href="/api/console/?function=search&amp;query=Paris&amp;reusability=open&amp;qf=IMAGE_SIZE:large">Test on API Console</a>

<p>Find all records that match the query Paris which have a thumbnail image, are of mime type image/jpeg and have an aspect ratio of 'landscape':</p>

<blockquote>
<p>search.json?wskey=xxxx&amp;query=Paris&amp;thumbnail=true&amp;qf=MIME_TYPE:image%2Fjpeg&amp;qf=IMAGE_ASPECTRATIO:landscape</p>
</blockquote>
<a href="/api/console/?function=search&amp;query=Paris&amp;thumbnail=true&amp;qf=MIME_TYPE:image%2Fjpeg&amp;qf=IMAGE_ASPECTRATIO:landscape">Test on API Console</a>

<p>Find all records where the subject is opera and where the results are sound files with a long duration:</p>

<blockquote>
<p>search.json?wskey=xxxx&amp;query=what:opera&amp;qf=SOUND_DURATION:long</p>
</blockquote>

<p></p>
<a href="/api/console/?function=search&amp;query=what:opera&amp;qf=SOUND_DURATION:long">Test on API Console</a>

<p></p>

<h2>Version 2.0.12 (2014-06-18)</h2>

<h3>/v2/translateQuery.json</h3>

<p>Translate a term to different languages and return a query string to use in the search API method. Right now this functionality is a wrapper around a Wikipedia API call.</p>

<p>Request parameters:</p>

<table>
	<thead>
		<tr>
			<th>Parameter</th>
			<th>Datatype</th>
			<th>Description</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>wskey</td>
			<td>String</td>
			<td>Your API key</td>
		</tr>
		<tr>
			<td>languageCodes</td>
			<td>String</td>
			<td>The ISO language codes separated by commas or spaces</td>
		</tr>
		<tr>
			<td>term</td>
			<td>String</td>
			<td>The term to translate</td>
		</tr>
	</tbody>
</table>

<p>Returns</p>

<table>
	<thead>
		<tr>
			<th>Name</th>
			<th>Datatype</th>
			<th>Description</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>translations</td>
			<td>Array</td>
			<td>A list of translations. Each translation contains two fields:<br />
			text: the text of the translation<br />
			languageCode: the ISO language code of the translation</td>
		</tr>
		<tr>
			<td>translatedQuery</td>
			<td>String</td>
			<td>A query string where each translations are concatenated by the boolean OR operator.</td>
		</tr>
	</tbody>
</table>

<p>Example</p>

<p>Get the translations of Notre Dame</p>

<p>http://europeana.eu/api/v2/translateQuery.json?languageCodes=nl,en,hu&amp;wskey=xxxxxxxx&amp;term=notre%20dame</p>

<p>It returns</p>

<pre>
<code class="language-JavaScript">{
"apikey": "xxxxxxxx",
"action": "translateQuery.json",
"success": true,
"requestNumber": 8957,
"translations": [
{
"text": "Notre-Dame",
"languageCode": "nl"
},
{
"text": "Notre Dame",
"languageCode": "en"
},
{
"text": "Notre Dame",
"languageCode": "de"
}
],
"translatedQuery": "Notre-Dame OR \"Notre Dame\""
}
</code></pre>

<p>For background information see the blog post <a href="http://blog.europeana.eu/2014/08/improving-search-across-languages/">Improving search across languages</a></p>

<h3>Renaming field "europeanaCollectionName" to "edmDatasetName"</h3>

<p>Following the change in Europeana Data Model schema, we add edmDatasetName with the same content as the europeanaCollectionName. For a grace period we keep both fields, but next year we will return only edmDatasetName, so please update your API client. The field is available in search, object and provider calls.</p>

<h2>Version 2.0.10 (2014-02-13)</h2>

<h3>Timestamps of creation and modification</h3>

<p>New values in search and full record responses, giving information about when the particular record was created and updated. We provide these information both as UNIX timestamp, and as a more human readable ISO 8601 format (ISO 8601 Data elements and interchange formats – Information interchange – Representation of dates and times.http://en.wikipedia.org/wiki/ISO_8601).</p>

<ul>
	<li><strong>timestamp_created_epoch</strong>: UNIX timestamp of the date when record was created</li>
	<li><strong>timestamp_update_epoch</strong>: UNIX timestamp of the date when record was last updated</li>
	<li><strong>timestamp_created</strong>: ISO 8601 format of the date when record was created</li>
	<li><strong>timestamp_update</strong>: ISO 8601 format of the date when record was last updated</li>
</ul>

<h4>Examples</h4>

<p>Search response:</p>

<pre>
<code class="language-JavaScript">{
"apikey": "xxxxxxxxxx",
"action": "search.json",
...
"items": [
{
...
"timestamp_created_epoch": 1385744622879,
"timestamp_update_epoch": 1385744622879,
"timestamp_created": "2013-11-29T18:03:42.879Z",
"timestamp_update": "2013-11-29T18:03:42.879Z"
...
},
...
],
...
}
</code></pre>

<p>Record response:</p>

<pre>
<code class="language-JavaScript">{
"apikey": "xxxxxxxxxx",
"action": "record.json",
...
"object": {
...
"timestamp_created_epoch": 1385744622879,
"timestamp_update_epoch": 1385744622879,
"timestamp_created": "2013-11-29T18:03:42.879Z",
"timestamp_update": "2013-11-29T18:03:42.879Z"
},
...
}
</code></pre>

<p>You even search for this information:</p>

<p>Searching for a particular date:</p>

<pre>
<code>&amp;query=timestamp_created:"2013-03-16T20:26:27.168Z"
&amp;query=timestamp_update:"2013-03-16T20:26:27.168Z"
</code></pre>

<p>searching for date range (as [date1 TO date2]):</p>

<pre>
<code>&amp;query=timestamp_created:["2013-03-15T19:58:36.43Z"+TO+"2013-04-15T19:58:36.43Z"]
&amp;query=timestamp_update:["2013-03-15T19:58:36.43Z"+TO+"2013-04-15T19:58:36.43Z"]
</code></pre>

<p>Solr's date mathematics is also works: [xxx TO NOW] = untill now:</p>

<pre>
<code>&amp;query=timestamp_created:[2013-10-06T23:59:59.999Z+TO+NOW]
&amp;query=timestamp_update:[2013-10-06T23:59:59.999Z+TO+NOW]
</code></pre>

<p>[xxx TO NOW+1DAY] = untill tomorrow:</p>

<pre>
<code>&amp;query=timestamp_created:[2013-10-06T23:59:59.999Z+TO+NOW%2B1DAY]
&amp;query=timestamp_update:[2013-10-06T23:59:59.999Z+TO+NOW%2B1DAY]
</code></pre>

<p>[xxx TO NOW-1DAY] = untill yesterday:</p>

<pre>
<code>&amp;query=timestamp_created:[2013-10-06T23:59:59.999Z+TO+NOW-1DAY]
&amp;query=timestamp_update:[2013-10-06T23:59:59.999Z+TO+NOW-1DAY]
</code></pre>

<p>[NOW-2MONTH/DAY TO NOW/DAY] = last two months:</p>

<pre>
<code>&amp;query=timestamp_created:[NOW-2MONTH/DAY+TO+NOW/DAY]
&amp;query=timestamp_update:[NOW-2MONTH/DAY+TO+NOW/DAY]
</code></pre>

<p>Keep in mind, that + sign should be encoded as %2B, otherwise it will be taken as space, and results an invalid Solr query. More on Solr date math syntax: (http://lucene.apache.org/solr/4_6_0/solr-core/org/apache/solr/util/DateMathParser.html)</p>

<h3>Retrieving individual facets</h3>

<p>So far the user could get the default facets Europeana set. From now on the API users can select which facets they would like to retrieve. We have introduced a new parameter: facet. When you request facet you have to set the profile either as facets or as portal (which covers facets as well).</p>

<p>The value of the parameter could be "DEFAULT" (which is a shortcut of the Europeana facet set we make use on the portal, which contains UGC, LANGUAGE, TYPE, YEAR, PROVIDER, DATA_PROVIDER, COUNTRY and RIGHTS), or any field name which is indexed and stored in Apache Solr. We maintain a table in API documentation about the existing fields: <a href="/api/data-fields/">API fields</a>. In the field type column "text" means indexed as as a row of distinct terms, while "string" means indexed as phrase, so the whole content is taken as one individual unit.</p>

<p>Users can set one or more facets in one query.</p>

<p>Requesting a single facet:</p>

<p>&amp;facet=proxy_dc_contributor&amp;profile=facets</p>

<p>Requesting multiple facets can be done with three different syntaxes. You can add multiple facet parameters, or one facet parameter with multiple values separated by commas or spaces:</p>

<p>multiple facet parameters</p>

<p>&amp;facet=proxy_dc_coverage&amp;facet=proxy_dc_contributor&amp;profile=facets</p>

<p>multiple facets separated by commas</p>

<p>&amp;facet=proxy_dc_coverage,proxy_dc_contributor&amp;profile=facets</p>

<p>multiple facets separated by spaces</p>

<p>&amp;facet=proxy_dc_coverage%20proxy_dc_contributor&amp;profile=facets</p>

<p>&amp;facet=proxy_dc_coverage+proxy_dc_contributor&amp;profile=facets</p>

<p>Requesting the default facets:</p>

<p>&amp;profile=portal</p>

<p>&amp;profile=facets</p>

<p>&amp;facet=DEFAULT&amp;profile=facets</p>

<p>Combining default facets with custom facets:</p>

<p>&amp;facet=DEFAULT+proxy_dc_contributor&amp;profile=facets</p>

<p>Offset and limit of facets</p>

<p>The API user can set how many facet values she would like to retrieve, and which should be the first one. With this parameters, she can page over all facet values without requesting too much at a time. The limit and offset parameter syntax is a little bit tricky, but if you are familiar with Apache Solr syntax, it won't be strange, because it is the same.</p>

<p>f.[facet name].facet.limit such as &amp;f.PROVIDER.facet.limit=30 f.[facet name].facet.offset such as &amp;f.PROVIDER.facet.offset=30</p>

<p>Both parameters accept numeric values.</p>

<p>The default offset value is 0, it means no offset, the first item to return is the first item in the list. 1 offset the list by one, so the first item to return is the second and so on.</p>

<p>In limit 0 means not to return anything.</p>

<p>The special DEFAULT shortcut works here as well, and it limit the facets which are part of the above mentioned set. So &amp;f.DEFAULT.facet.limit=20 works for RIGHTS, and PROVIDER, but doesn't work for non default facets such as proxy_dc_contributor.</p>

<h2>Version 2.0.8 (2013-10-23)</h2>

<h3>New parameter: reusability</h3>

<p>The new <code>reusability</code> parameter can have two possible values: Open and Limited. It is an additional filter, which selects those items, which can be reusable free, or in a limited way. They are shorthands for a couple of right values:</p>

<p>Free:</p>

<ul>
	<li>NOC: http://creativecommons.org/publicdomain/mark/</li>
	<li>CC-ZERO: http://creativecommons.org/publicdomain/zero/1.0/*</li>
	<li>CC-BY: http://creativecommons.org/licenses/by/</li>
	<li>CC-BY-SA: http://creativecommons.org/licenses/by-sa/</li>
</ul>

<p>Limited:</p>

<ul>
	<li>CC-BY-NC: http://creativecommons.org/licenses/by-nc/</li>
	<li>CC-BY-NC-SA: http://creativecommons.org/licenses/by-nc-sa/</li>
	<li>CC-BY-NC-ND: http://creativecommons.org/licenses/by-nc-nd/</li>
	<li>CC-BY-ND: http://creativecommons.org/licenses/by-nd/</li>
	<li>OOC-NC: http://www.europeana.eu/rights/out-of-copyright-non-commercial/</li>
</ul>

<p>It has double effects 1) it filter the search result with the appropriate right values, 2) if facets are requested, it provides a new facet, called REUSABILITY.</p>

<p>Example:</p>

<pre>
<code>http://localhost:8080/api/v2/search.json?wskey=api2demo&amp;query=*:*&amp;reusability=free&amp;qf=TYPE:VIDEO&amp;profile=portal
</code></pre>

<p>returns</p>

<pre>
<code class="language-JavaScript">{
"apikey": "xxxxxxxxxx",
"action": "search.json",
...
"items": [ … ],
...
"facets": [
...
{
"name": "REUSABILITY",
"fields": [
{"label": "Limited", "count": 9795},
{"label": "Free", "count": 3659}
]
}
]
}
</code></pre>

<h2>Version 2.0.6 (2013-08-09)</h2>

<h3>New response profile: params</h3>

<p>New allowable value for the <em>profile</em> parameter: <code>params</code>. When client adds <code>params</code> to the <em>profile</em> parameter, the header of the response will contain a <code>params</code> key, which lists the requested and default parameters of the API call. The client can use profile <em>profile</em> parameter in search and object calls. The parameter accepts both single and multiple values separated by comma or space (such as <code>&amp;profile=standard</code> or <code>&amp;profile=standard,params</code> or <code>&amp;profile=standard%20params</code>).</p>

<p>Example:</p>

<pre>
<code>http://europeana.eu/api/v2/search.json?wskey=xxxxxxxx&amp;amp;query=mona+lisa&amp;amp;profile=standard%20params
</code></pre>

<p>returns</p>

<pre>
<code class="language-JavaScript">{
"apikey": "xxxxxxxxx",
"action": "search.json",
"success": true,
"requestNumber": 6,
"params": {
"query": "mona lisa",
"profile": "standard params",
"start": 1,
"rows": 12
},
"itemsCount": 12,
"totalResults": 195,
"items": [...]
}
</code></pre>
</section>
